{
    "@context": "https://www.w3.org/2022/wot/td/v1.1",
    "id": "test:test_rules",
    "title": "MyLampThing",
    "security": "basic_sc",
    "links": [
        {
            "rel": "subscribeEvent",
            "href": "https://example.com/things/mqtt/events/changes_example-device-rules",
            "type": "application/json"
        }
    ],
    "otv2:rules": {
        "update": {
            "otv2:description": "ASI SE ACTUALIZA REY",
            "otv2:if": {
                "==": [
                    {
                        "var": "eventName"
                    },
                    "mqtt:changes_example-device-rules"
                ]
            },
            "otv2:then": {
                "otv2:updateState": {
                    "temperature": {
                        "value": {
                            "var": "payload.temperature"
                        },
                        "timestamp": {
                            "var": "payload.timestamp"
                        }
                    }
                },
                "otv2:emitEvent": [
                    {"event" : "overheating"}
                ]
            }
        }
    },
    "properties": {
        "temperature": {
            "type": "number",
            "readOnly": false,
            "writeOnly": false,
            "observable": false,
            "forms": [
                {
                    "op": [
                        "readproperty",
                        "writeproperty"
                    ],
                    "href": "https://mylamp.example.com/status",
                    "contentType": "application/json"
                }
            ]
        }
    },
    "actions": {
        "toggle": {
            "safe": false,
            "idempotent": false,
            "forms": [
                {
                    "op": "invokeaction",
                    "href": "https://mylamp.example.com/toggle",
                    "contentType": "application/json"
                }
            ]
        }
    },
    "events": {
        "overheating": {
            "data": {
                "type": "string",
                "readOnly": false,
                "writeOnly": false
            },
            "forms": [
                {
                    "op": "subscribeevent",
                    "href": "https://mylamp.example.com/oh",
                    "contentType": "application/json",
                    "subprotocol": "longpoll"
                }
            ]
        },
        "com.example.mqtt.message": {
            "data": {
                "type": "string",
                "readOnly": false,
                "writeOnly": false
            },
            "forms": [
                {
                    "op": "subscribeevent",
                    "href": "https://mylamp.example.com/oh",
                    "contentType": "application/json",
                    "subprotocol": "longpoll"
                }
            ]
        }
    }
}
